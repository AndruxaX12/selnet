<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Всички сигнали - Моят Ботевград</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Шрифт Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Стил за цветните статуси (значки) */
        .status-badge {
            display: inline-block;
            padding: 0.125rem 0.625rem; /* py-0.5 px-2.5 */
            border-radius: 9999px; /* rounded-full */
            font-size: 0.75rem; /* text-xs */
            font-weight: 600; /* font-semibold */
            text-transform: capitalize;
        }
        .status-new {
            color: #b91c1c; /* red-800 */
            background-color: #fee2e2; /* red-100 */
        }
        .status-in-process {
            color: #b45309; /* yellow-700 */
            background-color: #fef9c3; /* yellow-100 */
        }
        .status-completed {
            color: #166534; /* green-800 */
            background-color: #dcfce7; /* green-100 */
        }

        /* Стил за placeholder-а на изображението в списъка */
        .list-image-placeholder {
            width: 160px; /* w-40 */
            height: 100px; /* h-24 */
            background-color: #f3f4f6; /* gray-100 */
            border: 1px solid #e5e7eb; /* border-gray-200 */
            border-radius: 0.5rem; /* rounded-lg */
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af; /* gray-400 */
            flex-shrink: 0;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">

    <!-- Header -->
    <header class="flex justify-between items-center px-4 py-2.5 border-b border-gray-200 z-50 bg-white shadow-sm sticky top-0">
        <!-- Left: Logo -->
        <div class="flex items-center gap-6">
            <a href="/" class="flex items-center">
                <div class="relative h-9 w-[180px] overflow-hidden">
                    <img src="/logo-selnet-full.png" alt="СелНет" class="h-9 w-auto object-contain object-left" id="logo-selnet" style="opacity: 1; transition: opacity 0.7s;">
                    <img src="/logo-botevgrad.png" alt="Моят Ботевград" class="absolute inset-0 h-9 w-auto object-contain object-left" id="logo-botevgrad" style="opacity: 0; transition: opacity 0.7s;">
                </div>
            </a>
            <nav class="hidden md:flex items-center">
                <a href="/signals" class="px-3 py-1.5 font-semibold text-sm text-gray-600 hover:text-green-600 transition-colors flex items-center gap-1.5 border border-gray-200 rounded-lg hover:border-green-400 hover:bg-green-50">
                    <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                    </svg>
                    Всички сигнали
                </a>
            </nav>
        </div>

        <!-- Right: Login button -->
        <div class="flex items-center gap-4">
            <a href="/login" class="px-4 py-2 bg-white text-gray-700 border border-gray-300 rounded-md font-semibold text-sm hover:bg-gray-50 transition-colors shadow-sm">
                Влез
            </a>
        </div>
    </header>

    <!-- Главно съдържание -->
    <main class="container mx-auto max-w-7xl p-4 sm:p-6 lg:p-8 flex-1">
        
        <!-- Заглавие на страницата -->
        <h1 class="text-3xl font-bold text-gray-900 mb-6">Всички сигнали</h1>

        <!-- Лента с филтри -->
        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 mb-6">
            <div class="flex flex-col md:flex-row md:items-center md:space-x-4 space-y-4 md:space-y-0">
                <!-- Филтри -->
                <div class="flex-1 flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-4 sm:space-y-0">
                    <span class="text-sm font-medium text-gray-600 flex-shrink-0">Филтрирай по:</span>
                    <select class="border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 text-sm">
                        <option>Категория (всички)</option>
                        <option>Пътна инфраструктура</option>
                        <option>Улично осветление</option>
                        <option>Замърсяване</option>
                    </select>
                    <select class="border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 text-sm">
                        <option>Статус (всички)</option>
                        <option>Нов</option>
                        <option>В процес</option>
                        <option>Завършен</option>
                    </select>
                    <select class="border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 text-sm">
                        <option>Дата на подаване</option>
                        <option>Най-нови</option>
                        <option>Най-стари</option>
                    </select>
                    <select class="border-gray-300 rounded-lg shadow-sm focus:border-green-500 focus:ring-green-500 text-sm">
                        <option>Населено място (всички)</option>
                        <option>гр. Ботевград</option>
                        <option>с. Врачеш</option>
                        <option>с. Трудовец</option>
                    </select>
                </div>
                
                <!-- Търсене -->
                <div class="relative w-full md:w-auto">
                    <input type="text" class="w-full md:w-72 border-gray-300 rounded-lg shadow-sm pl-10 pr-4 py-2 focus:border-green-500 focus:ring-green-500 text-sm" placeholder="Търси по № или ключова дума...">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </span>
                </div>
            </div>
        </div>

        <!-- Списък със сигнали -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
            <ul class="divide-y divide-gray-200">
                
                <!-- Сигнал 1 (Нов) -->
                <li class="p-4 hover:bg-gray-50 transition-colors">
                    <a href="#" class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-6">
                        <div class="list-image-placeholder">
                            <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" /></svg>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-xl font-semibold text-gray-900 mb-2">Опасна дупка на ул. Иван Вазов</h2>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-2 text-sm text-gray-700">
                                <div><strong class="text-gray-500">Сигнал №:</strong> 00106112025</div>
                                <div><strong class="text-gray-500">Категория:</strong> Пътна инфраструктура</div>
                                <div><strong class="text-gray-500">Подаден на:</strong> 04.11.2025 г.</div>
                                <div class="col-span-2"><strong class="text-gray-500">Местоположение:</strong> гр. Ботевград, ул. "Иван Вазов" №23</div>
                                <div><strong class="text-gray-500">Статус:</strong> <span class="status-badge status-new">нов</span></div>
                            </div>
                        </div>
                    </a>
                </li>

                <!-- Сигнал 2 (В процес) -->
                <li class="p-4 hover:bg-gray-50 transition-colors">
                    <a href="#" class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-6">
                        <div class="list-image-placeholder">
                            <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" /></svg>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-xl font-semibold text-gray-900 mb-2">Неработеща улична лампа</h2>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-2 text-sm text-gray-700">
                                <div><strong class="text-gray-500">Сигнал №:</strong> 00424102025</div>
                                <div><strong class="text-gray-500">Категория:</strong> Улично осветление</div>
                                <div><strong class="text-gray-500">Подаден на:</strong> 24.10.2025 г.</div>
                                <div class="col-span-2"><strong class="text-gray-500">Местоположение:</strong> с. Врачеш, ул. "Трети март" №88</div>
                                <div><strong class="text-gray-500">Статус:</strong> <span class="status-badge status-in-process">в процес</span></div>
                            </div>
                        </div>
                    </a>
                </li>

                <!-- Сигнал 3 (В процес) -->
                <li class="p-4 hover:bg-gray-50 transition-colors">
                    <a href="#" class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-6">
                        <div class="list-image-placeholder">
                            <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" /></svg>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-xl font-semibold text-gray-900 mb-2">Образувано сметище</h2>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-2 text-sm text-gray-700">
                                <div><strong class="text-gray-500">Сигнал №:</strong> 01223102025</div>
                                <div><strong class="text-gray-500">Категория:</strong> Замърсяване</div>
                                <div><strong class="text-gray-500">Подаден на:</strong> 23.10.2025 г.</div>
                                <div class="col-span-2"><strong class="text-gray-500">Местоположение:</strong> с. Трудовец</div>
                                <div><strong class="text-gray-500">Статус:</strong> <span class="status-badge status-in-process">в процес</span></div>
                            </div>
                        </div>
                    </a>
                </li>

                <!-- Сигнал 4 (Завършен) -->
                <li class="p-4 hover:bg-gray-50 transition-colors">
                    <a href="#" class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-6">
                        <div class="list-image-placeholder">
                            <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" /></svg>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-xl font-semibold text-gray-900 mb-2">Дърво с изсъхнали клони</h2>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-2 text-sm text-gray-700">
                                <div><strong class="text-gray-500">Сигнал №:</strong> 00722102025</div>
                                <div><strong class="text-gray-500">Категория:</strong> Зелена система</div>
                                <div><strong class="text-gray-500">Подаден на:</strong> 22.10.2025 г.</div>
                                <div class="col-span-2"><strong class="text-gray-500">Местоположение:</strong> гр. Ботевград, ул. "Витоша" №2</div>
                                <div><strong class="text-gray-500">Статус:</strong> <span class="status-badge status-completed">завършен</span></div>
                            </div>
                        </div>
                    </a>
                </li>

            </ul>
        </div>

    </main>

    <!-- 4. Футър - Взет от index.html -->
    <footer class="bg-white border-t border-gray-200 mt-10">
        <div class="container mx-auto max-w-7xl py-8 px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center text-sm text-gray-600">
            <div class="mb-4 md:mb-0">
                <span>Copyright © 2025 Моят Ботевград от ДАНТРИ Тех ООД.</span>
            </div>
            <div class="flex space-x-6">
                <a href="#" class="hover:text-green-600">Архив сигнали</a>
                <a href="#" class="hover:text-green-600">За платформата</a>
                <a href="#" class="hover:text-green-600">Условия за ползване</a>
                <a href="#" class="hover:text-green-600">Защита на личните данни</a>
            </div>
        </div>
    </footer>

    <!-- JavaScript за зареждане на сигнали от API -->
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const signalsList = document.querySelector('.divide-y');
            
            if (!signalsList) return;
            
            // Показване на loading
            signalsList.innerHTML = '<li class="p-8 text-center text-gray-500">Зареждане...</li>';
            
            try {
                const response = await fetch('/api/signals?limit=50');
                const data = await response.json();
                
                if (!data.items || data.items.length === 0) {
                    signalsList.innerHTML = '<li class="p-8 text-center text-gray-500">Няма намерени сигнали</li>';
                    return;
                }
                
                // Мапване на статусите
                const statusMap = {
                    'novo': { class: 'status-new', label: 'нов' },
                    'new': { class: 'status-new', label: 'нов' },
                    'potvurden': { class: 'status-in-process', label: 'потвърден' },
                    'v_proces': { class: 'status-in-process', label: 'в процес' },
                    'in_progress': { class: 'status-in-process', label: 'в процес' },
                    'popraven': { class: 'status-completed', label: 'завършен' },
                    'resolved': { class: 'status-completed', label: 'завършен' }
                };
                
                // Генериране на HTML
                signalsList.innerHTML = data.items.map((signal, index) => {
                    const statusInfo = statusMap[signal.status] || { class: 'status-new', label: signal.status };
                    const imageHtml = signal.photos && signal.photos.length > 0 
                        ? `<img src="${signal.photos[0]}" alt="${signal.title}" class="w-40 h-24 object-cover rounded-lg">`
                        : `<div class="list-image-placeholder">
                            <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
                            </svg>
                          </div>`;
                    
                    const date = new Date(signal.created_at);
                    const formattedDate = date.toLocaleDateString('bg-BG', { year: 'numeric', month: '2-digit', day: '2-digit' });
                    
                    return `
                        <li class="p-4 hover:bg-gray-50 transition-colors">
                            <a href="#" class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-6">
                                ${imageHtml}
                                <div class="flex-1">
                                    <h2 class="text-xl font-semibold text-gray-900 mb-2">${signal.title}</h2>
                                    <div class="grid grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-2 text-sm text-gray-700">
                                        <div><strong class="text-gray-500">Сигнал №:</strong> ${signal.id.slice(0, 12)}</div>
                                        <div><strong class="text-gray-500">Категория:</strong> ${signal.category || 'Друго'}</div>
                                        <div><strong class="text-gray-500">Подаден на:</strong> ${formattedDate} г.</div>
                                        <div class="col-span-2"><strong class="text-gray-500">Местоположение:</strong> ${signal.location?.address || 'Неизвестно'}</div>
                                        <div><strong class="text-gray-500">Статус:</strong> <span class="status-badge ${statusInfo.class}">${statusInfo.label}</span></div>
                                    </div>
                                </div>
                            </a>
                        </li>
                    `;
                }).join('');
                
            } catch (error) {
                console.error('Грешка при зареждане на сигнали:', error);
                signalsList.innerHTML = '<li class="p-8 text-center text-red-500">Грешка при зареждане на сигнали</li>';
            }
        });

        // Logo animation
        let showBotevgrad = false;
        setInterval(() => {
            const logoSelnet = document.getElementById('logo-selnet');
            const logoBotevgrad = document.getElementById('logo-botevgrad');
            
            if (showBotevgrad) {
                logoSelnet.style.opacity = '1';
                logoBotevgrad.style.opacity = '0';
            } else {
                logoSelnet.style.opacity = '0';
                logoBotevgrad.style.opacity = '1';
            }
            showBotevgrad = !showBotevgrad;
        }, 5000);
    </script>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-auto">
        <div class="container mx-auto max-w-7xl py-6 px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center text-sm text-gray-600">
            <div class="mb-4 md:mb-0 flex items-center gap-3">
                <img src="/logo-selnet-full.png" alt="СелНет" class="h-6 w-auto object-contain">
                <span class="text-gray-400">|</span>
                <span>© 2025 ДАНТРИ Тех ООД</span>
            </div>
            <nav class="flex flex-wrap justify-center md:justify-end gap-4 md:gap-6">
                <a href="/signals" class="hover:text-green-600 transition-colors">Архив сигнали</a>
                <a href="/about" class="hover:text-green-600 transition-colors">За платформата</a>
                <a href="/terms" class="hover:text-green-600 transition-colors">Условия за ползване</a>
                <a href="/privacy" class="hover:text-green-600 transition-colors">Защита на данни</a>
                <a href="/contact" class="hover:text-green-600 transition-colors">Контакти</a>
            </nav>
        </div>
    </footer>

</body>
</html>